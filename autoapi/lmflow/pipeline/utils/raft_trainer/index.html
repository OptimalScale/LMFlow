
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>lmflow.pipeline.utils.raft_trainer &#8212; LMFlow  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'autoapi/lmflow/pipeline/utils/raft_trainer/index';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="lmflow.pipeline.utils.rm_dataprocessor" href="../rm_dataprocessor/index.html" />
    <link rel="prev" title="lmflow.pipeline.utils.memory_safe_vllm_inference" href="../memory_safe_vllm_inference/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">We've released our memory-efficient finetuning algorithm LISA, check out [<a href='https://arxiv.org/pdf/2403.17919.pdf'>Paper</a>][<a href='https://github.com/OptimalScale/LMFlow#finetuning-lisa'>User Guide</a>] for more details!</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">LMFlow</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../blogs/index.html">
    Blogs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../../../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/OptimalScale/LMFlow" title="LMFlow" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../../../_static/logo5.svg" class="icon-link-image" alt="LMFlow"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../blogs/index.html">
    Blogs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../../../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../../about/index.html">
    About
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
            
          
          
          
          
          
          
          
          
          
          <a href="https://github.com/OptimalScale/LMFlow" title="LMFlow" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../../../_static/logo5.svg" class="icon-link-image" alt="LMFlow"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../index.html">lmflow</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../args/index.html">lmflow.args</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../datasets/index.html">lmflow.datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../datasets/dataset/index.html">lmflow.datasets.dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../datasets/multi_modal_dataset/index.html">lmflow.datasets.multi_modal_dataset</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../models/index.html">lmflow.models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../models/auto_model/index.html">lmflow.models.auto_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/base_model/index.html">lmflow.models.base_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/decoder_model/index.html">lmflow.models.decoder_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/encoder_decoder_model/index.html">lmflow.models.encoder_decoder_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/hf_decoder_model/index.html">lmflow.models.hf_decoder_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/hf_model_mixin/index.html">lmflow.models.hf_model_mixin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/hf_text_regression_model/index.html">lmflow.models.hf_text_regression_model</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../models/interfaces/index.html">lmflow.models.interfaces</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../models/interfaces/tunable/index.html">lmflow.models.interfaces.tunable</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/regression_model/index.html">lmflow.models.regression_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/text_regression_model/index.html">lmflow.models.text_regression_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../models/vision2seq_model/index.html">lmflow.models.vision2seq_model</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../models/vision_encoder/index.html">lmflow.models.vision_encoder</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../models/vision_encoder/clip_encoder/index.html">lmflow.models.vision_encoder.clip_encoder</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../optim/index.html">lmflow.optim</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adabelief/index.html">lmflow.optim.adabelief</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adabound/index.html">lmflow.optim.adabound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adadelta/index.html">lmflow.optim.adadelta</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adagrad/index.html">lmflow.optim.adagrad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adam/index.html">lmflow.optim.adam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adamax/index.html">lmflow.optim.adamax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adamp/index.html">lmflow.optim.adamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adamw_schedule_free/index.html">lmflow.optim.adamw_schedule_free</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/adan/index.html">lmflow.optim.adan</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/dummy/index.html">lmflow.optim.dummy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/lamb/index.html">lmflow.optim.lamb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/lars/index.html">lmflow.optim.lars</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/muon/index.html">lmflow.optim.muon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/nadam/index.html">lmflow.optim.nadam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/novograd/index.html">lmflow.optim.novograd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/optimizers/index.html">lmflow.optim.optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/radam/index.html">lmflow.optim.radam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/sgd_schedule_free/index.html">lmflow.optim.sgd_schedule_free</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/sgdp/index.html">lmflow.optim.sgdp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/sophia/index.html">lmflow.optim.sophia</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/utils/index.html">lmflow.optim.utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optim/yogi/index.html">lmflow.optim.yogi</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../index.html">lmflow.pipeline</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../auto_pipeline/index.html">lmflow.pipeline.auto_pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../base_aligner/index.html">lmflow.pipeline.base_aligner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../base_pipeline/index.html">lmflow.pipeline.base_pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../base_tuner/index.html">lmflow.pipeline.base_tuner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dpo_aligner/index.html">lmflow.pipeline.dpo_aligner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dpov2_aligner/index.html">lmflow.pipeline.dpov2_aligner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluator/index.html">lmflow.pipeline.evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../finetuner/index.html">lmflow.pipeline.finetuner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../inferencer/index.html">lmflow.pipeline.inferencer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../iterative_dpo_aligner/index.html">lmflow.pipeline.iterative_dpo_aligner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../raft_aligner/index.html">lmflow.pipeline.raft_aligner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rm_inferencer/index.html">lmflow.pipeline.rm_inferencer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rm_tuner/index.html">lmflow.pipeline.rm_tuner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sglang_inferencer/index.html">lmflow.pipeline.sglang_inferencer</a></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../index.html">lmflow.pipeline.utils</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../dpov2_dataprocessor/index.html">lmflow.pipeline.utils.dpov2_dataprocessor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpov2_trainer/index.html">lmflow.pipeline.utils.dpov2_trainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lisa_trainer/index.html">lmflow.pipeline.utils.lisa_trainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../memory_safe_dpov2_align/index.html">lmflow.pipeline.utils.memory_safe_dpov2_align</a></li>
<li class="toctree-l4"><a class="reference internal" href="../memory_safe_vllm_inference/index.html">lmflow.pipeline.utils.memory_safe_vllm_inference</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#">lmflow.pipeline.utils.raft_trainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rm_dataprocessor/index.html">lmflow.pipeline.utils.rm_dataprocessor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rm_trainer/index.html">lmflow.pipeline.utils.rm_trainer</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../vllm_inferencer/index.html">lmflow.pipeline.vllm_inferencer</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../tokenization/index.html">lmflow.tokenization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tokenization/hf_decoder_model/index.html">lmflow.tokenization.hf_decoder_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tokenization/hf_text_regression_model/index.html">lmflow.tokenization.hf_text_regression_model</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../utils/index.html">lmflow.utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/common/index.html">lmflow.utils.common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/constants/index.html">lmflow.utils.constants</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../utils/conversation_template/index.html">lmflow.utils.conversation_template</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/base/index.html">lmflow.utils.conversation_template.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/chatglm/index.html">lmflow.utils.conversation_template.chatglm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/chatml/index.html">lmflow.utils.conversation_template.chatml</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/deepseek/index.html">lmflow.utils.conversation_template.deepseek</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/gemma/index.html">lmflow.utils.conversation_template.gemma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/hymba/index.html">lmflow.utils.conversation_template.hymba</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/internlm/index.html">lmflow.utils.conversation_template.internlm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/llama/index.html">lmflow.utils.conversation_template.llama</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/phi/index.html">lmflow.utils.conversation_template.phi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/qwen/index.html">lmflow.utils.conversation_template.qwen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/yi/index.html">lmflow.utils.conversation_template.yi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/conversation_template/zephyr/index.html">lmflow.utils.conversation_template.zephyr</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/data_utils/index.html">lmflow.utils.data_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/deprecated/index.html">lmflow.utils.deprecated</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/envs/index.html">lmflow.utils.envs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/llava_conversation_lib/index.html">lmflow.utils.llava_conversation_lib</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/model/index.html">lmflow.utils.model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/multimodal/index.html">lmflow.utils.multimodal</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../utils/position_interpolation/index.html">lmflow.utils.position_interpolation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/position_interpolation/llama_rope_scaled_monkey_patch/index.html">lmflow.utils.position_interpolation.llama_rope_scaled_monkey_patch</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/protocol/index.html">lmflow.utils.protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/test_utils/index.html">lmflow.utils.test_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../utils/versioning/index.html">lmflow.utils.versioning</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../version/index.html">lmflow.version</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../profiler/index.html">profiler</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../../../index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../../index.html" class="nav-link">lmflow</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">lmflow.pipeline</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">lmflow.pipeline.utils</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">lmflow.pipeline.utils.raft_trainer</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-lmflow.pipeline.utils.raft_trainer">
<span id="lmflow-pipeline-utils-raft-trainer"></span><h1>lmflow.pipeline.utils.raft_trainer<a class="headerlink" href="#module-lmflow.pipeline.utils.raft_trainer" title="Link to this heading">#</a></h1>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.is_torch_greater_or_equal_than_1_10" title="lmflow.pipeline.utils.raft_trainer.is_torch_greater_or_equal_than_1_10"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_torch_greater_or_equal_than_1_10</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.is_torch_less_than_1_11" title="lmflow.pipeline.utils.raft_trainer.is_torch_less_than_1_11"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_torch_less_than_1_11</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer._is_native_cpu_amp_available" title="lmflow.pipeline.utils.raft_trainer._is_native_cpu_amp_available"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_is_native_cpu_amp_available</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.DEFAULT_CALLBACKS" title="lmflow.pipeline.utils.raft_trainer.DEFAULT_CALLBACKS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DEFAULT_CALLBACKS</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="lmflow.pipeline.utils.raft_trainer.DEFAULT_PROGRESS_CALLBACK"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DEFAULT_PROGRESS_CALLBACK</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id0" title="lmflow.pipeline.utils.raft_trainer.DEFAULT_PROGRESS_CALLBACK"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DEFAULT_PROGRESS_CALLBACK</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.IS_SAGEMAKER_MP_POST_1_10" title="lmflow.pipeline.utils.raft_trainer.IS_SAGEMAKER_MP_POST_1_10"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IS_SAGEMAKER_MP_POST_1_10</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.skip_first_batches" title="lmflow.pipeline.utils.raft_trainer.skip_first_batches"><code class="xref py py-obj docutils literal notranslate"><span class="pre">skip_first_batches</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.logger" title="lmflow.pipeline.utils.raft_trainer.logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logger</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.TRAINING_ARGS_NAME" title="lmflow.pipeline.utils.raft_trainer.TRAINING_ARGS_NAME"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TRAINING_ARGS_NAME</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.TRAINER_STATE_NAME" title="lmflow.pipeline.utils.raft_trainer.TRAINER_STATE_NAME"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TRAINER_STATE_NAME</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.OPTIMIZER_NAME" title="lmflow.pipeline.utils.raft_trainer.OPTIMIZER_NAME"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OPTIMIZER_NAME</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.SCHEDULER_NAME" title="lmflow.pipeline.utils.raft_trainer.SCHEDULER_NAME"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SCHEDULER_NAME</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.SCALER_NAME" title="lmflow.pipeline.utils.raft_trainer.SCALER_NAME"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SCALER_NAME</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer" title="lmflow.pipeline.utils.raft_trainer.RaftTrainer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RaftTrainer</span></code></a></p></td>
<td><p>Trainer is a simple but feature-complete training and eval loop for PyTorch, optimized for ðŸ¤— Transformers.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">#</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.is_torch_greater_or_equal_than_1_10">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">is_torch_greater_or_equal_than_1_10</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#is_torch_greater_or_equal_than_1_10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.is_torch_greater_or_equal_than_1_10" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.is_torch_less_than_1_11">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">is_torch_less_than_1_11</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#is_torch_less_than_1_11"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.is_torch_less_than_1_11" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer._is_native_cpu_amp_available">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">_is_native_cpu_amp_available</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#_is_native_cpu_amp_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer._is_native_cpu_amp_available" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.DEFAULT_CALLBACKS">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_CALLBACKS</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#DEFAULT_CALLBACKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.DEFAULT_CALLBACKS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.DEFAULT_PROGRESS_CALLBACK">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_PROGRESS_CALLBACK</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#DEFAULT_PROGRESS_CALLBACK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.DEFAULT_PROGRESS_CALLBACK" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_PROGRESS_CALLBACK</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#DEFAULT_PROGRESS_CALLBACK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.IS_SAGEMAKER_MP_POST_1_10">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">IS_SAGEMAKER_MP_POST_1_10</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#IS_SAGEMAKER_MP_POST_1_10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.IS_SAGEMAKER_MP_POST_1_10" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.skip_first_batches">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">skip_first_batches</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#skip_first_batches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.skip_first_batches" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.logger">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.logger" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.TRAINING_ARGS_NAME">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">TRAINING_ARGS_NAME</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'training_args.bin'</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#TRAINING_ARGS_NAME"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.TRAINING_ARGS_NAME" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.TRAINER_STATE_NAME">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">TRAINER_STATE_NAME</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'trainer_state.json'</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#TRAINER_STATE_NAME"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.TRAINER_STATE_NAME" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.OPTIMIZER_NAME">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">OPTIMIZER_NAME</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'optimizer.pt'</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#OPTIMIZER_NAME"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.OPTIMIZER_NAME" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.SCHEDULER_NAME">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">SCHEDULER_NAME</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scheduler.pt'</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#SCHEDULER_NAME"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.SCHEDULER_NAME" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.SCALER_NAME">
<span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">SCALER_NAME</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scaler.pt'</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#SCALER_NAME"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.SCALER_NAME" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lmflow.pipeline.utils.raft_trainer.</span></span><span class="sig-name descname"><span class="pre">RaftTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">transformers.modeling_utils.PreTrainedModel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.nn.Module</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">transformers.training_args.TrainingArguments</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_collator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">transformers.data.data_collator.DataCollator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.Dataset</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">transformers.tokenization_utils_base.PreTrainedTokenizerBase</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">transformers.modeling_utils.PreTrainedModel</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">transformers.trainer_utils.EvalPrediction</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">transformers.trainer_callback.TrainerCallback</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.optim.Optimizer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.optim.lr_scheduler.LambdaLR</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess_logits_for_metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer" title="Link to this definition">#</a></dt>
<dd><p>Trainer is a simple but feature-complete training and eval loop for PyTorch, optimized for ðŸ¤— Transformers.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>model ([<cite>PreTrainedModel</cite>] or <cite>torch.nn.Module</cite>, <em>optional</em>):</dt><dd><p>The model to train, evaluate or use for predictions. If not provided, a <cite>model_init</cite> must be passed.
&lt;Tip&gt;
[<cite>Trainer</cite>] is optimized to work with the [<cite>PreTrainedModel</cite>] provided by the library. You can still use
your own models defined as <cite>torch.nn.Module</cite> as long as they work the same way as the ðŸ¤— Transformers
models.
&lt;/Tip&gt;</p>
</dd>
<dt>args ([<cite>TrainingArguments</cite>], <em>optional</em>):</dt><dd><p>The arguments to tweak for training. Will default to a basic instance of [<cite>TrainingArguments</cite>] with the
<cite>output_dir</cite> set to a directory named <em>tmp_trainer</em> in the current directory if not provided.</p>
</dd>
<dt>data_collator (<cite>DataCollator</cite>, <em>optional</em>):</dt><dd><p>The function to use to form a batch from a list of elements of <cite>train_dataset</cite> or <cite>eval_dataset</cite>. Will
default to [<cite>default_data_collator</cite>] if no <cite>tokenizer</cite> is provided, an instance of
[<cite>DataCollatorWithPadding</cite>] otherwise.</p>
</dd>
<dt>train_dataset (<cite>torch.utils.data.Dataset</cite> or <cite>torch.utils.data.IterableDataset</cite>, <em>optional</em>):</dt><dd><p>The dataset to use for training. If it is a [<cite>~datasets.Dataset</cite>], columns not accepted by the
<cite>model.forward()</cite> method are automatically removed.
Note that if itâ€™s a <cite>torch.utils.data.IterableDataset</cite> with some randomization and you are training in a
distributed fashion, your iterable dataset should either use a internal attribute <cite>generator</cite> that is a
<cite>torch.Generator</cite> for the randomization that must be identical on all processes (and the Trainer will
manually set the seed of this <cite>generator</cite> at each epoch) or have a <cite>set_epoch()</cite> method that internally
sets the seed of the RNGs used.</p>
</dd>
<dt>eval_dataset (Union[<cite>torch.utils.data.Dataset</cite>, dict[str, <cite>torch.utils.data.Dataset</cite>]), <em>optional</em>):</dt><dd><p>The dataset to use for evaluation. If it is a [<cite>~datasets.Dataset</cite>], columns not accepted by the
<cite>model.forward()</cite> method are automatically removed. If it is a dictionary, it will evaluate on each
dataset prepending the dictionary key to the metric name.</p>
</dd>
<dt>tokenizer ([<cite>PreTrainedTokenizerBase</cite>], <em>optional</em>):</dt><dd><p>The tokenizer used to preprocess the data. If provided, will be used to automatically pad the inputs to the
maximum length when batching inputs, and it will be saved along the model to make it easier to rerun an
interrupted training or reuse the fine-tuned model.</p>
</dd>
<dt>model_init (<cite>Callable[[], PreTrainedModel]</cite>, <em>optional</em>):</dt><dd><p>A function that instantiates the model to be used. If provided, each call to [<cite>~Trainer.train</cite>] will start
from a new instance of the model as given by this function.
The function may have zero argument, or a single one containing the optuna/Ray Tune/SigOpt trial object, to
be able to choose different architectures according to hyper parameters (such as layer count, sizes of
inner layers, dropout probabilities etc).</p>
</dd>
<dt>compute_metrics (<cite>Callable[[EvalPrediction], dict]</cite>, <em>optional</em>):</dt><dd><p>The function that will be used to compute metrics at evaluation. Must take a [<cite>EvalPrediction</cite>] and return
a dictionary string to metric values.</p>
</dd>
<dt>callbacks (list of [<cite>TrainerCallback</cite>], <em>optional</em>):</dt><dd><p>A list of callbacks to customize the training loop. Will add those to the list of default callbacks
detailed in [here](callback).
If you want to remove one of the default callbacks used, use the [<cite>Trainer.remove_callback</cite>] method.</p>
</dd>
<dt>optimizers (<cite>tuple[torch.optim.Optimizer, torch.optim.lr_scheduler.LambdaLR]</cite>, <em>optional</em>): A tuple</dt><dd><p>containing the optimizer and the scheduler to use. Will default to an instance of [<cite>AdamW</cite>] on your model
and a scheduler given by [<cite>get_linear_schedule_with_warmup</cite>] controlled by <cite>args</cite>.</p>
</dd>
<dt>preprocess_logits_for_metrics (<cite>Callable[[torch.Tensor, torch.Tensor], torch.Tensor]</cite>, <em>optional</em>):</dt><dd><p>A function that preprocess the logits right before caching them at each evaluation step. Must take two
tensors, the logits and the labels, and return the logits once processed as desired. The modifications made
by this function will be reflected in the predictions received by <cite>compute_metrics</cite>.
Note that the labels (second parameter) will be <cite>None</cite> if the dataset does not have them.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Important attributes:</dt><dd><ul class="simple">
<li><p><strong>model</strong> â€“ Always points to the core model. If using a transformers model, it will be a [<cite>PreTrainedModel</cite>]
subclass.</p></li>
<li><p><strong>model_wrapped</strong> â€“ Always points to the most external model in case one or more other modules wrap the
original model. This is the model that should be used for the forward pass. For example, under <cite>DeepSpeed</cite>,
the inner model is wrapped in <cite>DeepSpeed</cite> and then again in <cite>torch.nn.DistributedDataParallel</cite>. If the inner
model hasnâ€™t been wrapped, then <cite>self.model_wrapped</cite> is the same as <cite>self.model</cite>.</p></li>
<li><p><strong>is_model_parallel</strong> â€“ Whether or not a model has been switched to a model parallel mode (different from
data parallelism, this means some of the model layers are split on different GPUs).</p></li>
<li><p><strong>place_model_on_device</strong> â€“ Whether or not to automatically place the model on the device - it will be set
to <cite>False</cite> if model parallel or deepspeed is used, or if the default
<cite>TrainingArguments.place_model_on_device</cite> is overridden to return <cite>False</cite> .</p></li>
<li><p><strong>is_in_train</strong> â€“ Whether or not a model is currently running <cite>train</cite> (e.g. when <cite>evaluate</cite> is called while
in <cite>train</cite>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.save_counter">
<span class="sig-name descname"><span class="pre">save_counter</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.save_counter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.save_counter" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.args">
<span class="sig-name descname"><span class="pre">args</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.args" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.hp_name">
<span class="sig-name descname"><span class="pre">hp_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.hp_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.hp_name" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.deepspeed">
<span class="sig-name descname"><span class="pre">deepspeed</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.deepspeed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.deepspeed" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_in_train">
<span class="sig-name descname"><span class="pre">is_in_train</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.is_in_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_in_train" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._memory_tracker">
<span class="sig-name descname"><span class="pre">_memory_tracker</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._memory_tracker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._memory_tracker" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.sharded_ddp">
<span class="sig-name descname"><span class="pre">sharded_ddp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.sharded_ddp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.sharded_ddp" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.fsdp">
<span class="sig-name descname"><span class="pre">fsdp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.fsdp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.fsdp" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.place_model_on_device">
<span class="sig-name descname"><span class="pre">place_model_on_device</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.place_model_on_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.place_model_on_device" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.data_collator">
<span class="sig-name descname"><span class="pre">data_collator</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.data_collator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.data_collator" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.train_dataset">
<span class="sig-name descname"><span class="pre">train_dataset</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.train_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.train_dataset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.eval_dataset">
<span class="sig-name descname"><span class="pre">eval_dataset</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.eval_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.eval_dataset" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.tokenizer">
<span class="sig-name descname"><span class="pre">tokenizer</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.tokenizer" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.model_wrapped">
<span class="sig-name descname"><span class="pre">model_wrapped</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.model_wrapped"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.model_wrapped" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_metrics">
<span class="sig-name descname"><span class="pre">compute_metrics</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.compute_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_metrics" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.preprocess_logits_for_metrics">
<span class="sig-name descname"><span class="pre">preprocess_logits_for_metrics</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.preprocess_logits_for_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.preprocess_logits_for_metrics" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.callback_handler">
<span class="sig-name descname"><span class="pre">callback_handler</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.callback_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.callback_handler" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._loggers_initialized">
<span class="sig-name descname"><span class="pre">_loggers_initialized</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._loggers_initialized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._loggers_initialized" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._signature_columns">
<span class="sig-name descname"><span class="pre">_signature_columns</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._signature_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._signature_columns" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_apex">
<span class="sig-name descname"><span class="pre">use_apex</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.use_apex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_apex" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_cuda_amp">
<span class="sig-name descname"><span class="pre">use_cuda_amp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.use_cuda_amp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_cuda_amp" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_cpu_amp">
<span class="sig-name descname"><span class="pre">use_cpu_amp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.use_cpu_amp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_cpu_amp" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.do_grad_scaling">
<span class="sig-name descname"><span class="pre">do_grad_scaling</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.do_grad_scaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.do_grad_scaling" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.state">
<span class="sig-name descname"><span class="pre">state</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.state" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.control">
<span class="sig-name descname"><span class="pre">control</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.control" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.current_flos">
<span class="sig-name descname"><span class="pre">current_flos</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.current_flos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.current_flos" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.hp_search_backend">
<span class="sig-name descname"><span class="pre">hp_search_backend</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.hp_search_backend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.hp_search_backend" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_tune_checkpoints">
<span class="sig-name descname"><span class="pre">use_tune_checkpoints</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.use_tune_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_tune_checkpoints" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.label_names">
<span class="sig-name descname"><span class="pre">label_names</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.label_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.label_names" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.can_return_loss">
<span class="sig-name descname"><span class="pre">can_return_loss</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.can_return_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.can_return_loss" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._train_batch_size">
<span class="sig-name descname"><span class="pre">_train_batch_size</span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._train_batch_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._train_batch_size" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.add_callback">
<span class="sig-name descname"><span class="pre">add_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.add_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.add_callback" title="Link to this definition">#</a></dt>
<dd><p>Add a callback to the current list of [<cite>~transformer.TrainerCallback</cite>].
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>callback (<cite>type</cite> or [<cite>~transformer.TrainerCallback</cite>]):</dt><dd><p>A [<cite>~transformer.TrainerCallback</cite>] class or an instance of a [<cite>~transformer.TrainerCallback</cite>]. In the
first case, will instantiate a member of that class.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.pop_callback">
<span class="sig-name descname"><span class="pre">pop_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.pop_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.pop_callback" title="Link to this definition">#</a></dt>
<dd><p>Remove a callback from the current list of [<cite>~transformer.TrainerCallback</cite>] and returns it.
If the callback is not found, returns <cite>None</cite> (and no error is raised).
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>callback (<cite>type</cite> or [<cite>~transformer.TrainerCallback</cite>]):</dt><dd><p>A [<cite>~transformer.TrainerCallback</cite>] class or an instance of a [<cite>~transformer.TrainerCallback</cite>]. In the
first case, will pop the first member of that class found in the list of callbacks.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>[<cite>~transformer.TrainerCallback</cite>]: The callback removed, if found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.remove_callback">
<span class="sig-name descname"><span class="pre">remove_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.remove_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.remove_callback" title="Link to this definition">#</a></dt>
<dd><p>Remove a callback from the current list of [<cite>~transformer.TrainerCallback</cite>].
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>callback (<cite>type</cite> or [<cite>~transformer.TrainerCallback</cite>]):</dt><dd><p>A [<cite>~transformer.TrainerCallback</cite>] class or an instance of a [<cite>~transformer.TrainerCallback</cite>]. In the
first case, will remove the first member of that class found in the list of callbacks.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._move_model_to_device">
<span class="sig-name descname"><span class="pre">_move_model_to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._move_model_to_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._move_model_to_device" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._set_signature_columns_if_needed">
<span class="sig-name descname"><span class="pre">_set_signature_columns_if_needed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._set_signature_columns_if_needed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._set_signature_columns_if_needed" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._remove_unused_columns">
<span class="sig-name descname"><span class="pre">_remove_unused_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../../datasets/index.html#lmflow.datasets.Dataset" title="lmflow.datasets.Dataset"><span class="pre">datasets.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._remove_unused_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._remove_unused_columns" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_collator_with_removed_columns">
<span class="sig-name descname"><span class="pre">_get_collator_with_removed_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_collator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._get_collator_with_removed_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_collator_with_removed_columns" title="Link to this definition">#</a></dt>
<dd><p>Wrap the data collator in a callable removing unused columns.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_train_sampler">
<span class="sig-name descname"><span class="pre">_get_train_sampler</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.Sampler</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._get_train_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_train_sampler" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_train_dataloader">
<span class="sig-name descname"><span class="pre">get_train_dataloader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.DataLoader</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.get_train_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_train_dataloader" title="Link to this definition">#</a></dt>
<dd><p>Returns the training [<cite>~torch.utils.data.DataLoader</cite>].
Will use no sampler if <cite>train_dataset</cite> does not implement <cite>__len__</cite>, a random sampler (adapted to distributed
training if necessary) otherwise.
Subclass and override this method if you want to inject some custom behavior.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_eval_sampler">
<span class="sig-name descname"><span class="pre">_get_eval_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.Sampler</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._get_eval_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_eval_sampler" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_eval_dataloader">
<span class="sig-name descname"><span class="pre">get_eval_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.DataLoader</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.get_eval_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_eval_dataloader" title="Link to this definition">#</a></dt>
<dd><p>Returns the evaluation [<cite>~torch.utils.data.DataLoader</cite>].
Subclass and override this method if you want to inject some custom behavior.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>eval_dataset (<cite>torch.utils.data.Dataset</cite>, <em>optional</em>):</dt><dd><p>If provided, will override <cite>self.eval_dataset</cite>. If it is a [<cite>~datasets.Dataset</cite>], columns not accepted
by the <cite>model.forward()</cite> method are automatically removed. It must implement <cite>__len__</cite>.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_test_dataloader">
<span class="sig-name descname"><span class="pre">get_test_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.utils.data.DataLoader</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.get_test_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_test_dataloader" title="Link to this definition">#</a></dt>
<dd><p>Returns the test [<cite>~torch.utils.data.DataLoader</cite>].
Subclass and override this method if you want to inject some custom behavior.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>test_dataset (<cite>torch.utils.data.Dataset</cite>, <em>optional</em>):</dt><dd><p>The test dataset to use. If it is a [<cite>~datasets.Dataset</cite>], columns not accepted by the
<cite>model.forward()</cite> method are automatically removed. It must implement <cite>__len__</cite>.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_optimizer_and_scheduler">
<span class="sig-name descname"><span class="pre">create_optimizer_and_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.create_optimizer_and_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_optimizer_and_scheduler" title="Link to this definition">#</a></dt>
<dd><p>Setup the optimizer and the learning rate scheduler.
We provide a reasonable default that works well. If you want to use something else, you can pass a tuple in the
Trainerâ€™s init through <cite>optimizers</cite>, or subclass and override this method (or <cite>create_optimizer</cite> and/or
<cite>create_scheduler</cite>) in a subclass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_optimizer">
<span class="sig-name descname"><span class="pre">create_optimizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.create_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_optimizer" title="Link to this definition">#</a></dt>
<dd><p>Setup the optimizer.
We provide a reasonable default that works well. If you want to use something else, you can pass a tuple in the
Trainerâ€™s init through <cite>optimizers</cite>, or subclass and override this method in a subclass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_optimizer_cls_and_kwargs">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_optimizer_cls_and_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">transformers.training_args.TrainingArguments</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.get_optimizer_cls_and_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_optimizer_cls_and_kwargs" title="Link to this definition">#</a></dt>
<dd><p>Returns the optimizer class and optimizer parameters based on the training arguments.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>args (<cite>transformers.training_args.TrainingArguments</cite>):</dt><dd><p>The training arguments for the training session.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_scheduler">
<span class="sig-name descname"><span class="pre">create_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_training_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.optim.Optimizer</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.create_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_scheduler" title="Link to this definition">#</a></dt>
<dd><p>Setup the scheduler. The optimizer of the trainer must have been set up either before this method is called or
passed as an argument.
Args:</p>
<blockquote>
<div><p>num_training_steps (int): The number of training steps to do.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.num_examples">
<span class="sig-name descname"><span class="pre">num_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.DataLoader</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.num_examples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.num_examples" title="Link to this definition">#</a></dt>
<dd><p>Helper to get number of samples in a [<cite>~torch.utils.data.DataLoader</cite>] by accessing its dataset. When
dataloader.dataset does not exist or has no length, estimates as best it can</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._hp_search_setup">
<span class="sig-name descname"><span class="pre">_hp_search_setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">optuna.Trial</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._hp_search_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._hp_search_setup" title="Link to this definition">#</a></dt>
<dd><p>HP search setup code</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._report_to_hp_search">
<span class="sig-name descname"><span class="pre">_report_to_hp_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">optuna.Trial</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._report_to_hp_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._report_to_hp_search" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._tune_save_checkpoint">
<span class="sig-name descname"><span class="pre">_tune_save_checkpoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._tune_save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._tune_save_checkpoint" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.call_model_init">
<span class="sig-name descname"><span class="pre">call_model_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.call_model_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.call_model_init" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.torch_jit_model_eval">
<span class="sig-name descname"><span class="pre">torch_jit_model_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.torch_jit_model_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.torch_jit_model_eval" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.ipex_optimize_model">
<span class="sig-name descname"><span class="pre">ipex_optimize_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.ipex_optimize_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.ipex_optimize_model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._wrap_model">
<span class="sig-name descname"><span class="pre">_wrap_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._wrap_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._wrap_model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resume_from_checkpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">optuna.Trial</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys_for_eval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_first_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.train" title="Link to this definition">#</a></dt>
<dd><p>Main training entry point.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>resume_from_checkpoint (<cite>str</cite> or <cite>bool</cite>, <em>optional</em>):</dt><dd><p>If a <cite>str</cite>, local path to a saved checkpoint as saved by a previous instance of [<cite>Trainer</cite>]. If a
<cite>bool</cite> and equals <cite>True</cite>, load the last checkpoint in <em>args.output_dir</em> as saved by a previous instance
of [<cite>Trainer</cite>]. If present, training will resume from the model/optimizer/scheduler states loaded here.</p>
</dd>
<dt>trial (<cite>optuna.Trial</cite> or <cite>dict[str, Any]</cite>, <em>optional</em>):</dt><dd><p>The trial run or the hyperparameter dictionary for hyperparameter search.</p>
</dd>
<dt>ignore_keys_for_eval (<cite>list[str]</cite>, <em>optional</em>)</dt><dd><p>A list of keys in the output of your model (if it is a dictionary) that should be ignored when
gathering predictions for evaluation during the training.</p>
</dd>
<dt>kwargs:</dt><dd><p>Additional keyword arguments used to hide deprecated arguments</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._one_train">
<span class="sig-name descname"><span class="pre">_one_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume_from_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys_for_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._one_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._one_train" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._inner_training_loop">
<span class="sig-name descname"><span class="pre">_inner_training_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume_from_checkpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys_for_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._inner_training_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._inner_training_loop" title="Link to this definition">#</a></dt>
<dd><p>0 This function serves to train one time
1 Update the self.train_dataset before calling this function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_output_dir">
<span class="sig-name descname"><span class="pre">_get_output_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trial</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._get_output_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_output_dir" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_from_checkpoint">
<span class="sig-name descname"><span class="pre">_load_from_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resume_from_checkpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._load_from_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_from_checkpoint" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_best_model">
<span class="sig-name descname"><span class="pre">_load_best_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._load_best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_best_model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._issue_warnings_after_load">
<span class="sig-name descname"><span class="pre">_issue_warnings_after_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_result</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._issue_warnings_after_load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._issue_warnings_after_load" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._maybe_log_save_evaluate">
<span class="sig-name descname"><span class="pre">_maybe_log_save_evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tr_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys_for_eval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._maybe_log_save_evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._maybe_log_save_evaluate" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_rng_state">
<span class="sig-name descname"><span class="pre">_load_rng_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._load_rng_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_rng_state" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._save_checkpoint">
<span class="sig-name descname"><span class="pre">_save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._save_checkpoint" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_optimizer_and_scheduler">
<span class="sig-name descname"><span class="pre">_load_optimizer_and_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._load_optimizer_and_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_optimizer_and_scheduler" title="Link to this definition">#</a></dt>
<dd><p>If optimizer and scheduler states exist, load them.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.hyperparameter_search">
<span class="sig-name descname"><span class="pre">hyperparameter_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">optuna.Trial</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'minimize'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">transformers.trainer_utils.HPSearchBackend</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">optuna.Trial</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">transformers.trainer_utils.BestRun</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.hyperparameter_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.hyperparameter_search" title="Link to this definition">#</a></dt>
<dd><p>Launch an hyperparameter search using <cite>optuna</cite> or <cite>Ray Tune</cite> or <cite>SigOpt</cite>. The optimized quantity is determined
by <cite>compute_objective</cite>, which defaults to a function returning the evaluation loss when no metric is provided,
the sum of all metrics otherwise.
&lt;Tip warning={true}&gt;
To use this method, you need to have provided a <cite>model_init</cite> when initializing your [<cite>Trainer</cite>]: we need to
reinitialize the model at each new run. This is incompatible with the <cite>optimizers</cite> argument, so you need to
subclass [<cite>Trainer</cite>] and override the method [<cite>~Trainer.create_optimizer_and_scheduler</cite>] for custom
optimizer/scheduler.
&lt;/Tip&gt;
Args:</p>
<blockquote>
<div><dl>
<dt>hp_space (<cite>Callable[[â€œoptuna.Trialâ€], dict[str, float]]</cite>, <em>optional</em>):</dt><dd><p>A function that defines the hyperparameter search space. Will default to
[<cite>~trainer_utils.default_hp_space_optuna</cite>] or [<cite>~trainer_utils.default_hp_space_ray</cite>] or
[<cite>~trainer_utils.default_hp_space_sigopt</cite>] depending on your backend.</p>
</dd>
<dt>compute_objective (<cite>Callable[[dict[str, float]], float]</cite>, <em>optional</em>):</dt><dd><p>A function computing the objective to minimize or maximize from the metrics returned by the <cite>evaluate</cite>
method. Will default to [<cite>~trainer_utils.default_compute_objective</cite>].</p>
</dd>
<dt>n_trials (<cite>int</cite>, <em>optional</em>, defaults to 100):</dt><dd><p>The number of trial runs to test.</p>
</dd>
<dt>direction (<cite>str</cite>, <em>optional</em>, defaults to <cite>â€œminimizeâ€</cite>):</dt><dd><p>Whether to optimize greater or lower objects. Can be <cite>â€œminimizeâ€</cite> or <cite>â€œmaximizeâ€</cite>, you should pick
<cite>â€œminimizeâ€</cite> when optimizing the validation loss, <cite>â€œmaximizeâ€</cite> when optimizing one or several metrics.</p>
</dd>
<dt>backend (<cite>str</cite> or [<cite>~training_utils.HPSearchBackend</cite>], <em>optional</em>):</dt><dd><p>The backend to use for hyperparameter search. Will default to optuna or Ray Tune or SigOpt, depending
on which one is installed. If all are installed, will default to optuna.</p>
</dd>
<dt>hp_name (<cite>Callable[[â€œoptuna.Trialâ€], str]]</cite>, <em>optional</em>):</dt><dd><p>A function that defines the trial/run name. Will default to None.</p>
</dd>
<dt>kwargs (<cite>dict[str, Any]</cite>, <em>optional</em>):</dt><dd><p>Additional keyword arguments passed along to <cite>optuna.create_study</cite> or <cite>ray.tune.run</cite>. For more
information see:
- the documentation of</p>
<blockquote>
<div><p>[optuna.create_study](<a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.study.create_study.html">https://optuna.readthedocs.io/en/stable/reference/generated/optuna.study.create_study.html</a>)</p>
</div></blockquote>
<ul class="simple">
<li><p>the documentation of [tune.run](<a class="reference external" href="https://docs.ray.io/en/latest/tune/api_docs/execution.html#tune-run">https://docs.ray.io/en/latest/tune/api_docs/execution.html#tune-run</a>)</p></li>
<li><p>the documentation of [sigopt](<a class="reference external" href="https://app.sigopt.com/docs/endpoints/experiments/create">https://app.sigopt.com/docs/endpoints/experiments/create</a>)</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>[<cite>trainer_utils.BestRun</cite>]: All the information about the best run. Experiment summary can be found in
<cite>run_summary</cite> attribute for Ray backend.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.log" title="Link to this definition">#</a></dt>
<dd><p>Log <cite>logs</cite> on the various objects watching training.
Subclass and override this method to inject custom behavior.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>logs (<cite>dict[str, float]</cite>):</dt><dd><p>The values to log.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._prepare_input">
<span class="sig-name descname"><span class="pre">_prepare_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._prepare_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._prepare_input" title="Link to this definition">#</a></dt>
<dd><p>Prepares one <cite>data</cite> before feeding it to the model, be it a tensor or a nested list/dictionary of tensors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._prepare_inputs">
<span class="sig-name descname"><span class="pre">_prepare_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._prepare_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._prepare_inputs" title="Link to this definition">#</a></dt>
<dd><p>Prepare <cite>inputs</cite> before feeding them to the model, converting them to tensors if they are not already and
handling potential state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_loss_context_manager">
<span class="sig-name descname"><span class="pre">compute_loss_context_manager</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.compute_loss_context_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_loss_context_manager" title="Link to this definition">#</a></dt>
<dd><p>A helper wrapper to group together context managers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.autocast_smart_context_manager">
<span class="sig-name descname"><span class="pre">autocast_smart_context_manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cache_enabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.autocast_smart_context_manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.autocast_smart_context_manager" title="Link to this definition">#</a></dt>
<dd><p>A helper wrapper that creates an appropriate context manager for <cite>autocast</cite> while feeding it the desired
arguments, depending on the situation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.training_step" title="Link to this definition">#</a></dt>
<dd><p>Perform a training step on a batch of inputs.
Subclass and override to inject custom behavior.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>model (<cite>nn.Module</cite>):</dt><dd><p>The model to train.</p>
</dd>
<dt>inputs (<cite>dict[str, Union[torch.Tensor, Any]]</cite>):</dt><dd><p>The inputs and targets of the model.
The dictionary will be unpacked before being fed to the model. Most models expect the targets under the
argument <cite>labels</cite>. Check your modelâ€™s documentation for all accepted arguments.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Return:</dt><dd><p><cite>torch.Tensor</cite>: The tensor with training loss on this batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_loss">
<span class="sig-name descname"><span class="pre">compute_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.compute_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_loss" title="Link to this definition">#</a></dt>
<dd><p>How the loss is computed by Trainer. By default, all models return the loss in the first element.
Subclass and override for custom behavior.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_local_process_zero">
<span class="sig-name descname"><span class="pre">is_local_process_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.is_local_process_zero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_local_process_zero" title="Link to this definition">#</a></dt>
<dd><p>Whether or not this process is the local (e.g., on one machine if training in a distributed fashion on several
machines) main process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_world_process_zero">
<span class="sig-name descname"><span class="pre">is_world_process_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.is_world_process_zero"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_world_process_zero" title="Link to this definition">#</a></dt>
<dd><p>Whether or not this process is the global main process (when training in a distributed fashion on several
machines, this is only going to be <cite>True</cite> for one process).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_internal_call</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.save_model" title="Link to this definition">#</a></dt>
<dd><p>Will save the model, so you can reload it using <cite>from_pretrained()</cite>.
Will only save from the main process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._save_tpu">
<span class="sig-name descname"><span class="pre">_save_tpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._save_tpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._save_tpu" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._save">
<span class="sig-name descname"><span class="pre">_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._save" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.store_flos">
<span class="sig-name descname"><span class="pre">store_flos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.store_flos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.store_flos" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._sorted_checkpoints">
<span class="sig-name descname"><span class="pre">_sorted_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PREFIX_CHECKPOINT_DIR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._sorted_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._sorted_checkpoints" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._rotate_checkpoints">
<span class="sig-name descname"><span class="pre">_rotate_checkpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">use_mtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._rotate_checkpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._rotate_checkpoints" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'eval'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Run evaluation and returns metrics.
The calling script will be responsible for providing a method to compute metrics, as they are task-dependent
(pass it to the init <cite>compute_metrics</cite> argument).
You can also subclass and override this method to inject custom behavior.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>eval_dataset (<cite>Dataset</cite>, <em>optional</em>):</dt><dd><p>Pass a dataset if you wish to override <cite>self.eval_dataset</cite>. If it is a [<cite>~datasets.Dataset</cite>], columns
not accepted by the <cite>model.forward()</cite> method are automatically removed. It must implement the <cite>__len__</cite>
method.</p>
</dd>
<dt>ignore_keys (<cite>Lst[str]</cite>, <em>optional</em>):</dt><dd><p>A list of keys in the output of your model (if it is a dictionary) that should be ignored when
gathering predictions.</p>
</dd>
<dt>metric_key_prefix (<cite>str</cite>, <em>optional</em>, defaults to <cite>â€œevalâ€</cite>):</dt><dd><p>An optional prefix to be used as the metrics key prefix. For example the metrics â€œbleuâ€ will be named
â€œeval_bleuâ€ if the prefix is â€œevalâ€ (default)</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>A dictionary containing the evaluation loss and the potential metrics computed from the predictions. The
dictionary also contains the epoch number which comes from the training state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">transformers.trainer_utils.PredictionOutput</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.predict" title="Link to this definition">#</a></dt>
<dd><p>Run prediction and returns predictions and potential metrics.
Depending on the dataset and your use case, your test dataset may contain labels. In that case, this method
will also return metrics, like in <cite>evaluate()</cite>.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>test_dataset (<cite>Dataset</cite>):</dt><dd><p>Dataset to run the predictions on. If it is an <cite>datasets.Dataset</cite>, columns not accepted by the
<cite>model.forward()</cite> method are automatically removed. Has to implement the method <cite>__len__</cite></p>
</dd>
<dt>ignore_keys (<cite>Lst[str]</cite>, <em>optional</em>):</dt><dd><p>A list of keys in the output of your model (if it is a dictionary) that should be ignored when
gathering predictions.</p>
</dd>
<dt>metric_key_prefix (<cite>str</cite>, <em>optional</em>, defaults to <cite>â€œtestâ€</cite>):</dt><dd><p>An optional prefix to be used as the metrics key prefix. For example the metrics â€œbleuâ€ will be named
â€œtest_bleuâ€ if the prefix is â€œtestâ€ (default)</p>
</dd>
</dl>
</div></blockquote>
<p>&lt;Tip&gt;
If your predictions or labels have different sequence length (for instance because youâ€™re doing dynamic padding
in a token classification task) the predictions will be padded (on the right) to allow for concatenation into
one array. The padding index is -100.
&lt;/Tip&gt;
Returns: <em>Namedtuple</em> A namedtuple with the following keys:</p>
<blockquote>
<div><ul class="simple">
<li><p>predictions (<cite>np.ndarray</cite>): The predictions on <cite>test_dataset</cite>.</p></li>
<li><p>label_ids (<cite>np.ndarray</cite>, <em>optional</em>): The labels (if the dataset contained some).</p></li>
<li><p>metrics (<cite>dict[str, float]</cite>, <em>optional</em>): The potential dictionary of metrics (if the dataset contained
labels).</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.evaluation_loop">
<span class="sig-name descname"><span class="pre">evaluation_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_loss_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'eval'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">transformers.trainer_utils.EvalLoopOutput</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.evaluation_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.evaluation_loop" title="Link to this definition">#</a></dt>
<dd><p>Prediction/evaluation loop, shared by <cite>Trainer.evaluate()</cite> and <cite>Trainer.predict()</cite>.
Works both with or without labels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._nested_gather">
<span class="sig-name descname"><span class="pre">_nested_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._nested_gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._nested_gather" title="Link to this definition">#</a></dt>
<dd><p>Gather value of <cite>tensors</cite> (tensor or list/tuple of nested tensors) and convert them to numpy before
concatenating them to <cite>gathered</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._pad_across_processes">
<span class="sig-name descname"><span class="pre">_pad_across_processes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._pad_across_processes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._pad_across_processes" title="Link to this definition">#</a></dt>
<dd><p>Recursively pad the tensors in a nested list/tuple/dictionary of tensors from all devices to the same size so
they can safely be gathered.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.prediction_step">
<span class="sig-name descname"><span class="pre">prediction_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_loss_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.prediction_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.prediction_step" title="Link to this definition">#</a></dt>
<dd><p>Perform an evaluation step on <cite>model</cite> using <cite>inputs</cite>.
Subclass and override to inject custom behavior.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>model (<cite>nn.Module</cite>):</dt><dd><p>The model to evaluate.</p>
</dd>
<dt>inputs (<cite>dict[str, Union[torch.Tensor, Any]]</cite>):</dt><dd><p>The inputs and targets of the model.
The dictionary will be unpacked before being fed to the model. Most models expect the targets under the
argument <cite>labels</cite>. Check your modelâ€™s documentation for all accepted arguments.</p>
</dd>
<dt>prediction_loss_only (<cite>bool</cite>):</dt><dd><p>Whether or not to return the loss only.</p>
</dd>
<dt>ignore_keys (<cite>Lst[str]</cite>, <em>optional</em>):</dt><dd><p>A list of keys in the output of your model (if it is a dictionary) that should be ignored when
gathering predictions.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Return:</dt><dd><p>tuple[Optional[torch.Tensor], Optional[torch.Tensor], Optional[torch.Tensor]]: A tuple with the loss,
logits and labels (each being optional).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.floating_point_ops">
<span class="sig-name descname"><span class="pre">floating_point_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.floating_point_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.floating_point_ops" title="Link to this definition">#</a></dt>
<dd><p>For models that inherit from [<cite>PreTrainedModel</cite>], uses that method to compute the number of floating point
operations for every backward + forward pass. If using another model, either implement such a method in the
model or subclass and override this method.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>inputs (<cite>dict[str, Union[torch.Tensor, Any]]</cite>):</dt><dd><p>The inputs and targets of the model.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p><cite>int</cite>: The number of floating-point operations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.init_git_repo">
<span class="sig-name descname"><span class="pre">init_git_repo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">at_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.init_git_repo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.init_git_repo" title="Link to this definition">#</a></dt>
<dd><p>Initializes a git repo in <cite>self.args.hub_model_id</cite>.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>at_init (<cite>bool</cite>, <em>optional</em>, defaults to <cite>False</cite>):</dt><dd><p>Whether this function is called before any training or not. If <cite>self.args.overwrite_output_dir</cite> is
<cite>True</cite> and <cite>at_init</cite> is <cite>True</cite>, the path to the repo (which is <cite>self.args.output_dir</cite>) might be wiped
out.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_model_card">
<span class="sig-name descname"><span class="pre">create_model_card</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">license</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finetuned_from</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tasks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.create_model_card"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_model_card" title="Link to this definition">#</a></dt>
<dd><p>Creates a draft of a model card using the information available to the <cite>Trainer</cite>.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>language (<cite>str</cite>, <em>optional</em>):</dt><dd><p>The language of the model (if applicable)</p>
</dd>
<dt>license (<cite>str</cite>, <em>optional</em>):</dt><dd><p>The license of the model. Will default to the license of the pretrained model used, if the original
model given to the <cite>Trainer</cite> comes from a repo on the Hub.</p>
</dd>
<dt>tags (<cite>str</cite> or <cite>list[str]</cite>, <em>optional</em>):</dt><dd><p>Some tags to be included in the metadata of the model card.</p>
</dd>
<dt>model_name (<cite>str</cite>, <em>optional</em>):</dt><dd><p>The name of the model.</p>
</dd>
<dt>finetuned_from (<cite>str</cite>, <em>optional</em>):</dt><dd><p>The name of the model used to fine-tune this one (if applicable). Will default to the name of the repo
of the original model given to the <cite>Trainer</cite> (if it comes from the Hub).</p>
</dd>
<dt>tasks (<cite>str</cite> or <cite>list[str]</cite>, <em>optional</em>):</dt><dd><p>One or several task identifiers, to be included in the metadata of the model card.</p>
</dd>
<dt>dataset_tags (<cite>str</cite> or <cite>list[str]</cite>, <em>optional</em>):</dt><dd><p>One or several dataset tags, to be included in the metadata of the model card.</p>
</dd>
<dt>dataset (<cite>str</cite> or <cite>list[str]</cite>, <em>optional</em>):</dt><dd><p>One or several dataset identifiers, to be included in the metadata of the model card.</p>
</dd>
<dt>dataset_args (<cite>str</cite> or <cite>list[str]</cite>, <em>optional</em>):</dt><dd><p>One or several dataset arguments, to be included in the metadata of the model card.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._push_from_checkpoint">
<span class="sig-name descname"><span class="pre">_push_from_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_folder</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._push_from_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._push_from_checkpoint" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.push_to_hub">
<span class="sig-name descname"><span class="pre">push_to_hub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">commit_message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'End</span> <span class="pre">of</span> <span class="pre">training'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocking</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.push_to_hub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.push_to_hub" title="Link to this definition">#</a></dt>
<dd><p>Upload <em>self.model</em> and <em>self.tokenizer</em> to the ðŸ¤— model hub on the repo <em>self.args.hub_model_id</em>.
Parameters:</p>
<blockquote>
<div><dl class="simple">
<dt>commit_message (<cite>str</cite>, <em>optional</em>, defaults to <cite>â€œEnd of trainingâ€</cite>):</dt><dd><p>Message to commit while pushing.</p>
</dd>
<dt>blocking (<cite>bool</cite>, <em>optional</em>, defaults to <cite>True</cite>):</dt><dd><p>Whether the function should return only when the <cite>git push</cite> has finished.</p>
</dd>
<dt>kwargs:</dt><dd><p>Additional keyword arguments passed along to [<cite>~Trainer.create_model_card</cite>].</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>The url of the commit of your model in the given repository if <cite>blocking=False</cite>, a tuple with the url of
the commit and an object to track the progress of the commit if <cite>blocking=True</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer.prediction_loop">
<span class="sig-name descname"><span class="pre">prediction_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_loss_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_key_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'eval'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">transformers.trainer_utils.EvalLoopOutput</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer.prediction_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.prediction_loop" title="Link to this definition">#</a></dt>
<dd><p>Prediction/evaluation loop, shared by <cite>Trainer.evaluate()</cite> and <cite>Trainer.predict()</cite>.
Works both with or without labels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._gather_and_numpify">
<span class="sig-name descname"><span class="pre">_gather_and_numpify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._gather_and_numpify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._gather_and_numpify" title="Link to this definition">#</a></dt>
<dd><p>Gather value of <cite>tensors</cite> (tensor or list/tuple of nested tensors) and convert them to numpy before
concatenating them to <cite>gathered</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lmflow.pipeline.utils.raft_trainer.RaftTrainer._add_sm_patterns_to_gitignore">
<span class="sig-name descname"><span class="pre">_add_sm_patterns_to_gitignore</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/lmflow/pipeline/utils/raft_trainer.html#RaftTrainer._add_sm_patterns_to_gitignore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._add_sm_patterns_to_gitignore" title="Link to this definition">#</a></dt>
<dd><p>Add SageMaker Checkpointing patterns to .gitignore file.</p>
</dd></dl>

</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../memory_safe_vllm_inference/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">lmflow.pipeline.utils.memory_safe_vllm_inference</p>
      </div>
    </a>
    <a class="right-next"
       href="../rm_dataprocessor/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">lmflow.pipeline.utils.rm_dataprocessor</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classes">Classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.is_torch_greater_or_equal_than_1_10"><code class="docutils literal notranslate"><span class="pre">is_torch_greater_or_equal_than_1_10</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.is_torch_less_than_1_11"><code class="docutils literal notranslate"><span class="pre">is_torch_less_than_1_11</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer._is_native_cpu_amp_available"><code class="docutils literal notranslate"><span class="pre">_is_native_cpu_amp_available</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.DEFAULT_CALLBACKS"><code class="docutils literal notranslate"><span class="pre">DEFAULT_CALLBACKS</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.DEFAULT_PROGRESS_CALLBACK"><code class="docutils literal notranslate"><span class="pre">DEFAULT_PROGRESS_CALLBACK</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">DEFAULT_PROGRESS_CALLBACK</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.IS_SAGEMAKER_MP_POST_1_10"><code class="docutils literal notranslate"><span class="pre">IS_SAGEMAKER_MP_POST_1_10</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.skip_first_batches"><code class="docutils literal notranslate"><span class="pre">skip_first_batches</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.TRAINING_ARGS_NAME"><code class="docutils literal notranslate"><span class="pre">TRAINING_ARGS_NAME</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.TRAINER_STATE_NAME"><code class="docutils literal notranslate"><span class="pre">TRAINER_STATE_NAME</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.OPTIMIZER_NAME"><code class="docutils literal notranslate"><span class="pre">OPTIMIZER_NAME</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.SCHEDULER_NAME"><code class="docutils literal notranslate"><span class="pre">SCHEDULER_NAME</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.SCALER_NAME"><code class="docutils literal notranslate"><span class="pre">SCALER_NAME</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer"><code class="docutils literal notranslate"><span class="pre">RaftTrainer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.save_counter"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.save_counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.args"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.args</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.hp_name"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.hp_name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.deepspeed"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.deepspeed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_in_train"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.is_in_train</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._memory_tracker"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._memory_tracker</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.sharded_ddp"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.sharded_ddp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.fsdp"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.fsdp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.place_model_on_device"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.place_model_on_device</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.data_collator"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.data_collator</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.train_dataset"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.train_dataset</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.eval_dataset"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.eval_dataset</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.tokenizer"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.tokenizer</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.model_wrapped"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.model_wrapped</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.model"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.model</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_metrics"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.compute_metrics</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.preprocess_logits_for_metrics"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.preprocess_logits_for_metrics</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.callback_handler"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.callback_handler</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._loggers_initialized"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._loggers_initialized</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._signature_columns"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._signature_columns</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_apex"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.use_apex</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_cuda_amp"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.use_cuda_amp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_cpu_amp"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.use_cpu_amp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.do_grad_scaling"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.do_grad_scaling</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.state"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.state</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.control"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.control</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.current_flos"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.current_flos</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.hp_search_backend"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.hp_search_backend</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.use_tune_checkpoints"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.use_tune_checkpoints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.label_names"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.label_names</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.can_return_loss"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.can_return_loss</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._train_batch_size"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._train_batch_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.add_callback"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.add_callback()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.pop_callback"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.pop_callback()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.remove_callback"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.remove_callback()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._move_model_to_device"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._move_model_to_device()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._set_signature_columns_if_needed"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._set_signature_columns_if_needed()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._remove_unused_columns"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._remove_unused_columns()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_collator_with_removed_columns"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._get_collator_with_removed_columns()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_train_sampler"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._get_train_sampler()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_train_dataloader"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.get_train_dataloader()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_eval_sampler"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._get_eval_sampler()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_eval_dataloader"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.get_eval_dataloader()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_test_dataloader"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.get_test_dataloader()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_optimizer_and_scheduler"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.create_optimizer_and_scheduler()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_optimizer"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.create_optimizer()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.get_optimizer_cls_and_kwargs"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.get_optimizer_cls_and_kwargs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_scheduler"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.create_scheduler()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.num_examples"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.num_examples()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._hp_search_setup"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._hp_search_setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._report_to_hp_search"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._report_to_hp_search()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._tune_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._tune_save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.call_model_init"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.call_model_init()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.torch_jit_model_eval"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.torch_jit_model_eval()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.ipex_optimize_model"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.ipex_optimize_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._wrap_model"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._wrap_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.train"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.train()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._one_train"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._one_train()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._inner_training_loop"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._inner_training_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._get_output_dir"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._get_output_dir()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_from_checkpoint"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._load_from_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_best_model"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._load_best_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._issue_warnings_after_load"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._issue_warnings_after_load()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._maybe_log_save_evaluate"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._maybe_log_save_evaluate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_rng_state"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._load_rng_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._save_checkpoint"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._load_optimizer_and_scheduler"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._load_optimizer_and_scheduler()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.hyperparameter_search"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.hyperparameter_search()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.log"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.log()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._prepare_input"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._prepare_input()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._prepare_inputs"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._prepare_inputs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_loss_context_manager"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.compute_loss_context_manager()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.autocast_smart_context_manager"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.autocast_smart_context_manager()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.training_step"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.training_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.compute_loss"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.compute_loss()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_local_process_zero"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.is_local_process_zero()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.is_world_process_zero"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.is_world_process_zero()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.save_model"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.save_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._save_tpu"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._save_tpu()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._save"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._save()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.store_flos"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.store_flos()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._sorted_checkpoints"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._sorted_checkpoints()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._rotate_checkpoints"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._rotate_checkpoints()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.evaluate"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.evaluate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.predict"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.evaluation_loop"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.evaluation_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._nested_gather"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._nested_gather()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._pad_across_processes"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._pad_across_processes()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.prediction_step"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.prediction_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.floating_point_ops"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.floating_point_ops()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.init_git_repo"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.init_git_repo()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.create_model_card"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.create_model_card()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._push_from_checkpoint"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._push_from_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.push_to_hub"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.push_to_hub()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer.prediction_loop"><code class="docutils literal notranslate"><span class="pre">RaftTrainer.prediction_loop()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._gather_and_numpify"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._gather_and_numpify()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lmflow.pipeline.utils.raft_trainer.RaftTrainer._add_sm_patterns_to_gitignore"><code class="docutils literal notranslate"><span class="pre">RaftTrainer._add_sm_patterns_to_gitignore()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../../_sources/autoapi/lmflow/pipeline/utils/raft_trainer/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright LMFlow 2025.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>